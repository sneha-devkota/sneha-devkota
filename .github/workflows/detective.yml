name: Generate detective animation
on:
  schedule: # execute every 12 hours
    - cron: "0 */12 * * *"
  workflow_dispatch:
  push:
    branches:
    - master
    - main
jobs:
  generate:
    permissions:
      contents: write
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Generate detective.svg
        run: |
          mkdir -p dist
          cat > dist/detective.svg << 'EOF'
          <svg width="800" height="400" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <!-- GitHub contribution grid colors -->
              <style>
                .bg { fill: #0d1117; }
                .grid-0 { fill: #161b22; stroke: #1c2128; }
                .grid-1 { fill: #0e4429; stroke: #0e4429; }
                .grid-2 { fill: #006d32; stroke: #006d32; }
                .grid-3 { fill: #26a641; stroke: #26a641; }
                .grid-4 { fill: #39d353; stroke: #39d353; }
                .detective-text { fill: #00ffff; font-family: 'Courier New', monospace; font-size: 36px; font-weight: bold; }
                .subtitle-text { fill: #ffd700; font-family: 'Courier New', monospace; font-size: 14px; }
                .magnifier { fill: none; stroke: #ffd700; stroke-width: 3; }
                .evidence { fill: #ffd700; stroke: #ffd700; }
                .fingerprint { fill: none; stroke: #00ffff; stroke-width: 2; opacity: 0.6; }
                .footprint { fill: #ffd700; opacity: 0.7; }
                
                /* Animations */
                .grid-pulse { animation: gridPulse 4s ease-in-out infinite; }
                .magnifier-move { animation: searchMove 8s ease-in-out infinite; }
                .evidence-pulse { animation: evidencePulse 2s ease-in-out infinite; }
                .text-glow { animation: textGlow 3s ease-in-out infinite alternate; }
                .fingerprint-rotate { animation: rotate 10s linear infinite; }
                .footprint-fade { animation: footprintFade 6s ease-in-out infinite; }
                
                @keyframes gridPulse {
                  0%, 100% { opacity: 0.6; }
                  50% { opacity: 1; }
                }
                
                @keyframes searchMove {
                  0% { transform: translate(0, 0); }
                  25% { transform: translate(50px, -20px); }
                  50% { transform: translate(-30px, 40px); }
                  75% { transform: translate(60px, 30px); }
                  100% { transform: translate(0, 0); }
                }
                
                @keyframes evidencePulse {
                  0%, 100% { transform: scale(1); opacity: 0.8; }
                  50% { transform: scale(1.3); opacity: 1; }
                }
                
                @keyframes textGlow {
                  0% { filter: drop-shadow(0 0 10px #00ffff); }
                  100% { filter: drop-shadow(0 0 20px #00ffff) drop-shadow(0 0 30px #00ffff); }
                }
                
                @keyframes rotate {
                  from { transform: rotate(0deg); }
                  to { transform: rotate(360deg); }
                }
                
                @keyframes footprintFade {
                  0%, 20% { opacity: 0; }
                  30%, 70% { opacity: 0.7; }
                  80%, 100% { opacity: 0; }
                }
              </style>
            </defs>
            
            <!-- Background -->
            <rect width="800" height="400" class="bg"/>
            
            <!-- GitHub-style contribution grid -->
            <g transform="translate(150, 80)">
              <!-- Generate grid pattern -->
              <g id="contribution-grid">
                <!-- Week 1 -->
                <rect x="0" y="0" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 0s"/>
                <rect x="0" y="12" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 0.1s"/>
                <rect x="0" y="24" width="8" height="8" rx="2" class="grid-2 grid-pulse" style="animation-delay: 0.2s"/>
                <rect x="0" y="36" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 0.3s"/>
                <rect x="0" y="48" width="8" height="8" rx="2" class="grid-3 grid-pulse" style="animation-delay: 0.4s"/>
                <rect x="0" y="60" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 0.5s"/>
                <rect x="0" y="72" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 0.6s"/>
                
                <!-- Week 2 -->
                <rect x="12" y="0" width="8" height="8" rx="2" class="grid-2 grid-pulse" style="animation-delay: 0.7s"/>
                <rect x="12" y="12" width="8" height="8" rx="2" class="grid-4 grid-pulse" style="animation-delay: 0.8s"/>
                <rect x="12" y="24" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 0.9s"/>
                <rect x="12" y="36" width="8" height="8" rx="2" class="grid-3 grid-pulse" style="animation-delay: 1s"/>
                <rect x="12" y="48" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 1.1s"/>
                <rect x="12" y="60" width="8" height="8" rx="2" class="grid-2 grid-pulse" style="animation-delay: 1.2s"/>
                <rect x="12" y="72" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 1.3s"/>
                
                <!-- Week 3-52 (abbreviated pattern) -->
                <rect x="24" y="0" width="8" height="8" rx="2" class="grid-3 grid-pulse" style="animation-delay: 1.4s"/>
                <rect x="24" y="12" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 1.5s"/>
                <rect x="24" y="24" width="8" height="8" rx="2" class="grid-4 grid-pulse" style="animation-delay: 1.6s"/>
                <rect x="24" y="36" width="8" height="8" rx="2" class="grid-2 grid-pulse" style="animation-delay: 1.7s"/>
                <rect x="24" y="48" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 1.8s"/>
                <rect x="24" y="60" width="8" height="8" rx="2" class="grid-3 grid-pulse" style="animation-delay: 1.9s"/>
                <rect x="24" y="72" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 2s"/>
                
                <!-- More weeks... (pattern continues) -->
                <rect x="36" y="0" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 2.1s"/>
                <rect x="36" y="12" width="8" height="8" rx="2" class="grid-2 grid-pulse" style="animation-delay: 2.2s"/>
                <rect x="36" y="24" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 2.3s"/>
                <rect x="36" y="36" width="8" height="8" rx="2" class="grid-4 grid-pulse" style="animation-delay: 2.4s"/>
                <rect x="36" y="48" width="8" height="8" rx="2" class="grid-3 grid-pulse" style="animation-delay: 2.5s"/>
                <rect x="36" y="60" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 2.6s"/>
                <rect x="36" y="72" width="8" height="8" rx="2" class="grid-2 grid-pulse" style="animation-delay: 2.7s"/>
                
                <!-- Extended grid pattern -->
                <rect x="48" y="0" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 2.8s"/>
                <rect x="48" y="12" width="8" height="8" rx="2" class="grid-3 grid-pulse" style="animation-delay: 2.9s"/>
                <rect x="48" y="24" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 3s"/>
                <rect x="48" y="36" width="8" height="8" rx="2" class="grid-2 grid-pulse" style="animation-delay: 3.1s"/>
                <rect x="48" y="48" width="8" height="8" rx="2" class="grid-4 grid-pulse" style="animation-delay: 3.2s"/>
                <rect x="48" y="60" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 3.3s"/>
                <rect x="48" y="72" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 3.4s"/>
                
                <!-- More pattern repetitions up to 52 weeks -->
                <rect x="60" y="0" width="8" height="8" rx="2" class="grid-2 grid-pulse" style="animation-delay: 3.5s"/>
                <rect x="60" y="12" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 3.6s"/>
                <rect x="60" y="24" width="8" height="8" rx="2" class="grid-3 grid-pulse" style="animation-delay: 3.7s"/>
                <rect x="60" y="36" width="8" height="8" rx="2" class="grid-1 grid-pulse" style="animation-delay: 3.8s"/>
                <rect x="60" y="48" width="8" height="8" rx="2" class="grid-0 grid-pulse" style="animation-delay: 3.9s"/>
                <rect x="60" y="60" width="8" height="8" rx="2" class="grid-4 grid-pulse" style="animation-delay: 4s"/>
                <rect x="60" y="72" width="8" height="8" rx="2" class="grid-2 grid-pulse" style="animation-delay: 4.1s"/>
              </g>
            </g>
            
            <!-- Magnifying glass -->
            <g class="magnifier-move" transform="translate(100, 50)">
              <circle cx="0" cy="0" r="20" class="magnifier"/>
              <line x1="14" y1="14" x2="28" y2="28" class="magnifier" stroke-linecap="round"/>
            </g>
            
            <!-- Evidence markers -->
            <circle cx="200" cy="120" r="6" class="evidence evidence-pulse" style="animation-delay: 0s"/>
            <circle cx="350" cy="180" r="6" class="evidence evidence-pulse" style="animation-delay: 0.5s"/>
            <circle cx="450" cy="140" r="6" class="evidence evidence-pulse" style="animation-delay: 1s"/>
            <circle cx="300" cy="220" r="6" class="evidence evidence-pulse" style="animation-delay: 1.5s"/>
            
            <!-- Connection lines -->
            <line x1="200" y1="120" x2="350" y2="180" stroke="#ffd700" stroke-width="2" opacity="0.6">
              <animate attributeName="stroke-dasharray" values="0,1000;1000,0" dur="3s" repeatCount="indefinite"/>
            </line>
            <line x1="350" y1="180" x2="450" y2="140" stroke="#ffd700" stroke-width="2" opacity="0.6">
              <animate attributeName="stroke-dasharray" values="0,1000;1000,0" dur="3s" repeatCount="indefinite" begin="1s"/>
            </line>
            
            <!-- Fingerprints -->
            <g class="fingerprint-rotate" transform="translate(600, 100)">
              <circle cx="0" cy="0" r="15" class="fingerprint"/>
              <circle cx="0" cy="0" r="12" class="fingerprint"/>
              <circle cx="0" cy="0" r="9" class="fingerprint"/>
              <circle cx="0" cy="0" r="6" class="fingerprint"/>
            </g>
            
            <g class="fingerprint-rotate" transform="translate(650, 250)" style="animation-delay: -3s">
              <circle cx="0" cy="0" r="15" class="fingerprint"/>
              <circle cx="0" cy="0" r="12" class="fingerprint"/>
              <circle cx="0" cy="0" r="9" class="fingerprint"/>
              <circle cx="0" cy="0" r="6" class="fingerprint"/>
            </g>
            
            <!-- Footprints -->
            <g class="footprint-fade" style="animation-delay: 0s">
              <ellipse cx="80" cy="300" rx="8" ry="12" class="footprint" transform="rotate(-15 80 300)"/>
              <circle cx="76" cy="290" r="2" class="footprint"/>
              <circle cx="80" cy="288" r="2" class="footprint"/>
              <circle cx="84" cy="290" r="2" class="footprint"/>
            </g>
            
            <g class="footprint-fade" style="animation-delay: -2s">
              <ellipse cx="120" cy="320" rx="8" ry="12" class="footprint" transform="rotate(10 120 320)"/>
              <circle cx="116" cy="310" r="2" class="footprint"/>
              <circle cx="120" cy="308" r="2" class="footprint"/>
              <circle cx="124" cy="310" r="2" class="footprint"/>
            </g>
            
            <g class="footprint-fade" style="animation-delay: -4s">
              <ellipse cx="160" cy="340" rx="8" ry="12" class="footprint" transform="rotate(-5 160 340)"/>
              <circle cx="156" cy="330" r="2" class="footprint"/>
              <circle cx="160" cy="328" r="2" class="footprint"/>
              <circle cx="164" cy="330" r="2" class="footprint"/>
            </g>
            
            <!-- Main title -->
            <text x="400" y="280" text-anchor="middle" class="detective-text text-glow">DETECTIVE</text>
            <text x="400" y="310" text-anchor="middle" class="subtitle-text">Investigating the Digital Crime Scene</text>
            
            <!-- Case status -->
            <text x="400" y="350" text-anchor="middle" class="subtitle-text">üîç Evidence Found ‚Ä¢ üî¥ Clues Analyzed ‚Ä¢ üü° Investigation Active</text>
          </svg>
          EOF
      
      - name: push detective.svg to the output branch
        uses: crazy-max/ghaction-github-pages@v3.1.0
        with:
          target_branch: output
          build_dir: dist
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
